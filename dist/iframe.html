
<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <style type="text/css">

    body {
      margin: 0;
      padding: 0;
    }

    iframe {
      border: 0;
    }

    section#viz-controller {
      padding: 20px;
    }

    .hidden {
      display: block;
    }

    .visible {
      display: block;
    }

    </style>
  </head>
  <body>
    <iframe id="viz" src="./index.html" frameBorder="0" seamless width="100%" height="700"></iframe>
    <section id="viz-controller" class="hidden">
      <h1>Change Visualisation</h1>
      <select onchange="onChangeSelector(this)">
        <option value="none">-- Select one --</option>
        <option value="Viz06">Visualisation 06</option>
        <option value="Viz10">Visualisation 10</option>
      </select>
    </section>
  </body>

  <script type="text/javascript">
    var iframe = document.querySelector('#viz');
    var app;
    var tracks = {
      Viz06: 'audio/INDIGO-PALACE-FIVERS.mp3',
      Viz10: 'audio/NELICK-VILLA-FEAT-ANDY-LUIDJE.mp3',
    }

    function onChangeSelector(target){
      if(target.value === 'none') return;

      app.changeViz({
        trackSrc: tracks[target.value],
        vizId: target.value
      });
    };

    /**
    function called from viz app when base assets are loaded
    and aplication is ready to be controlled
    */
    function onVizReady() {
      app = iframe.contentWindow.app;
      document.querySelector('#viz-controller').classList.remove('hidden');
      document.querySelector('#viz-controller').classList.add('visible');

      // app.pause();
      // app.play();
      // app.mute();

      // iframe.contentWindow.addEventListener('onTrackEnd', onEvent, false);
      // iframe.contentWindow.addEventListener('onTrackLoaded', onEvent, false);

    }
  </script>
</html>
